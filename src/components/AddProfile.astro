---
import { app } from "../firebase/server";
import { getFirestore } from "firebase-admin/firestore";
import FormInput from "./FormInput.astro";
import FormModal from "./FormModal.astro";

const handleSubmit = async () => {
  const data = await Astro.request.formData();
  const name = data.get("name");
  const role = data.get("role");
  const yearCourse = data.get("yearCourse");
  const verse = data.get("verse");
  const bio = data.get("bio");

  const db = getFirestore(app);
  await db.collection("profiles").add({
    name,
    role,
    yearCourse,
    verse,
    bio,
  });

};
---

<FormModal title="Add Profile" onSubmit={handleSubmit}>
  <>
    <FormInput
      label="Name"
      inputProps={{
        type: "text",
        name: "name",
        id: "name",
        placeholder: "Enter name here",
        required: true,
      }}
    />
    <FormInput
      label="Role"
      inputProps={{
        type: "text",
        name: "role",
        id: "role",
        placeholder: "Enter role here",
        required: true,
      }}
    />
    <FormInput
      label="Course and Year"
      inputProps={{
        type: "text",
        name: "yearCourse",
        id: "yearCourse",
        placeholder: "E.g. 2nd year Maths",
        required: true,
      }}
    />
    <FormInput
      label="Verse"
      inputProps={{
        type: "text",
        name: "verse",
        id: "verse",
        placeholder: "e.g. John 3:16",
        required: true,
      }}
    />
    <FormInput
      label="Bio"
      inputProps={{
        type: "text",
        name: "bio",
        id: "bio",
        placeholder: "Enter bio here",
        required: true,
      }}
    />
  </>
</Modal>
